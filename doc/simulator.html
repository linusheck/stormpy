<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Working with Simulators &#8212; stormpy 1.6.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

    <style>
        .navbar p {
            padding: 0px 5px;
        }

        /* fix navbar overlaying contents when clicking on anchors */
        :target::before {
            content: "";
            display: block;
            height: 60px; /* fixed header height*/
            margin: -60px 0 0; /* negative fixed header height */
            background: none;
        }

        /* hack to limit the yellow highlight to the the children of the target,
           because of the above hack the target's highlight would be way too large */
        dt:target {
            background-color: transparent;
        }
        dt:target > * {
            background-color: #fbe54e;
        }

        /* spacing adjustments */
        .section {
            margin-bottom: 10rem;
            margin-top: 6rem;
        }
        div.body > .section:first-of-type {
            margin-top: 0rem;
        }
        .class, .function, .data {
            margin-top: 5rem;
            margin-bottom: 7rem;
            border-left: 1px solid #eee;
            padding-left: 1rem;
        }
        dl.attribute > dd, dl.class > dd, dl.function > dd, dl.method > dd {
            margin-left: 30px;
        }
        p {
            margin-top: 1.05em;
            margin-bottom: 1.05em;
            text-align: justify;
        }
        .field-list p, li p {
            text-align: left;
        }
        /* adjust font sizes */
        dl.field-list, dl.attribute {
            font-size: 90%;
        }
        .math {
            font-size: 90.09%;
        }
    </style>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Stormpy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.6.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.stormchecker.org">Storm</a></li>
                <li><a href="https://github.com/moves-rwth/stormpy">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Stormpy <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#A-Quick-Tour-through-Stormpy">A Quick Tour through Stormpy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics.html">Advanced Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_models.html">Building Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/building_dtmcs.html">Discrete-time Markov chains (DTMCs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/building_mdps.html">Markov decision processes (MDPs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/building_ctmcs.html">Continuous-time Markov chains (CTMCs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/building_mas.html">Markov automata (MAs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="exploration.html">Exploring Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="reward_models.html">Reward Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedulers.html">Working with Schedulers</a></li>
<li class="toctree-l2"><a class="reference internal" href="shortest_paths.html">Working with Shortest Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametric_models.html">Parametric Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="dfts.html">Dynamic Fault Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="gspns.html">Generalized Stochastic Petri Nets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/core.html">Stormpy.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/info.html">Stormpy.info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/exceptions.html">Stormpy.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/logic.html">Stormpy.logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/storage.html">Stormpy.storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utility.html">Stormpy.utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/dft.html">Stormpy.dft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/gspn.html">Stormpy.gspn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/pars.html">Stormpy.pars</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Working with Simulators</a><ul>
<li><a class="reference internal" href="#Model-based-simulation">Model-based simulation</a><ul>
<li><a class="reference internal" href="#DTMCs">DTMCs</a><ul>
<li><a class="reference internal" href="#Explicit-state-representations">Explicit state-representations</a></li>
<li><a class="reference internal" href="#Program-level-representations">Program-level representations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#MDPs">MDPs</a><ul>
<li><a class="reference internal" href="#Explicit-representations">Explicit representations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Program-level-simulator">Program-level simulator</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Working with Simulators</a><ul>
<li><a class="reference internal" href="#Model-based-simulation">Model-based simulation</a><ul>
<li><a class="reference internal" href="#DTMCs">DTMCs</a><ul>
<li><a class="reference internal" href="#Explicit-state-representations">Explicit state-representations</a></li>
<li><a class="reference internal" href="#Program-level-representations">Program-level representations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#MDPs">MDPs</a><ul>
<li><a class="reference internal" href="#Explicit-representations">Explicit representations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Program-level-simulator">Program-level simulator</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
  Interactive version:
  <span style="white-space: nowrap;"><a href="https://mybinder.org/v2/gh/moves-rwth/stormpy/master?filepath=notebooks/doc/simulator.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge_logo.svg" style="vertical-align:text-bottom"></a>.</span>
</div>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><section id="Working-with-Simulators">
<h1>Working with Simulators<a class="headerlink" href="#Working-with-Simulators" title="Permalink to this heading">¶</a></h1>
<p>The simulators in stormpy are meant to mimic access to unknown models, but they can also be used to explore the model.</p>
<p>All simulators implement the abstract class <code class="docutils literal notranslate"><span class="pre">stormpy.simulator.Simulator</span></code>.</p>
<p>The simulators differ in the model representation they use in the background and in the representation of the states and actions exposed to the user. We will go through some options by example!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stormpy</span>
<span class="kn">import</span> <span class="nn">stormpy.examples</span>
<span class="kn">import</span> <span class="nn">stormpy.examples.files</span>
<span class="kn">import</span> <span class="nn">stormpy.simulator</span>
</pre></div>
</div>
</div>
<section id="Model-based-simulation">
<h2>Model-based simulation<a class="headerlink" href="#Model-based-simulation" title="Permalink to this heading">¶</a></h2>
<p>We first start with an explicit model-based simulation. This means that we have a model of the DTMC in memory. This is fast and convenient if the model is available, but limits the size of models that we support.</p>
<section id="DTMCs">
<h3>DTMCs<a class="headerlink" href="#DTMCs" title="Permalink to this heading">¶</a></h3>
<p>We first discuss the interface for DTMCs, without any nondeterminism.</p>
<section id="Explicit-state-representations">
<h4>Explicit state-representations<a class="headerlink" href="#Explicit-state-representations" title="Permalink to this heading">¶</a></h4>
<p>After importing some parts of stormpy as above, we start with creating a model, in this case a DTMC:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">prism_dtmc_die</span>
<span class="n">prism_program</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_prism_program</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">prism_program</span><span class="p">)</span>

<span class="n">simulator</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">create_simulator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let us simulate a path.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0, [0.0], {&#39;init&#39;})
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, [1.0], set())
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5, [1.0], set())
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(11, [1.0], {&#39;done&#39;, &#39;five&#39;})
</pre></div></div>
</div>
<p>We start the simulator by restarting. We then do 3 steps. Every step returns a triple (state, reward, labels). In particular, the simulation above reflects a path s0, s2, s5, s11. Taking the transitions inbetween yields the reward as shown above. While states s2 and s5 are not labelled, state s0 is labelled with <code class="docutils literal notranslate"><span class="pre">init</span></code> and state s11 is labelled with <code class="docutils literal notranslate"><span class="pre">done</span></code> and <code class="docutils literal notranslate"><span class="pre">five</span></code>. Indeed we can check this information on the model that we used for the simulator:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">labeling</span><span class="o">.</span><span class="n">get_labels_of_state</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;done&#39;, &#39;five&#39;}
</pre></div></div>
</div>
<p>We can continue sampling.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(11, [0.0], {&#39;done&#39;, &#39;five&#39;})
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(11, [0.0], {&#39;done&#39;, &#39;five&#39;})
</pre></div></div>
</div>
<p>Indeed, we are not leaving the state. In this case, we can never leave the state as state s11 is absorbing. The simulator detects and exposes this information via <code class="docutils literal notranslate"><span class="pre">simulator.is_done()</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<p>We can sample more paths, yielding (potentially) different final states:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
<span class="n">final_outcomes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
        <span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">observation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">final_outcomes</span><span class="p">:</span>
        <span class="n">final_outcomes</span><span class="p">[</span><span class="n">observation</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">final_outcomes</span><span class="p">[</span><span class="n">observation</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
<span class="n">final_outcomes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{7: 21, 9: 16, 10: 18, 11: 17, 12: 16, 8: 12}
</pre></div></div>
</div>
</section>
<section id="Program-level-representations">
<h4>Program-level representations<a class="headerlink" href="#Program-level-representations" title="Permalink to this heading">¶</a></h4>
<p>We can run the same simulator but represent states symbolically, referring to the high-level description of the state rather than on its internal index. The advantage of this is that the process becomes independent of the underlying representation of the model. We first need to build the model with the required annotations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">BuilderOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">set_build_state_valuations</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_sparse_model_with_options</span><span class="p">(</span><span class="n">prism_program</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Then, we create simulator that uses program-level state observations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">create_simulator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">set_observation_mode</span><span class="p">(</span><span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">SimulatorObservationMode</span><span class="o">.</span><span class="n">PROGRAM_LEVEL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
<span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;{\n    &#34;d&#34;: 0,\n    &#34;s&#34;: 0\n}&#39;
</pre></div></div>
</div>
<p>Indeed, the state is now an object that describes the state in terms of the variables of prism program, in this case variables “s” and “d”.</p>
<p>We can use the simulator as before, e.g.,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
<span class="n">final_outcomes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">simulator</span><span class="o">.</span><span class="n">get_reward_names</span><span class="p">())</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
        <span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">observation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">final_outcomes</span><span class="p">:</span>
        <span class="n">final_outcomes</span><span class="p">[</span><span class="n">observation</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">final_outcomes</span><span class="p">[</span><span class="n">observation</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">final_outcomes</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;coin_flips&#39;]
{
    &#34;d&#34;: 5,
    &#34;s&#34;: 7
}: 18, {
    &#34;d&#34;: 4,
    &#34;s&#34;: 7
}: 19, {
    &#34;d&#34;: 2,
    &#34;s&#34;: 7
}: 13, {
    &#34;d&#34;: 6,
    &#34;s&#34;: 7
}: 16, {
    &#34;d&#34;: 3,
    &#34;s&#34;: 7
}: 14, {
    &#34;d&#34;: 1,
    &#34;s&#34;: 7
}: 20
</pre></div></div>
</div>
</section>
</section>
<section id="MDPs">
<h3>MDPs<a class="headerlink" href="#MDPs" title="Permalink to this heading">¶</a></h3>
<section id="Explicit-representations">
<h4>Explicit representations<a class="headerlink" href="#Explicit-representations" title="Permalink to this heading">¶</a></h4>
<p>As above, we can represent states both explicitly or symbolically. We only discuss the explicit representation here. With nondeterminism, we now must resolve this nondeterminism externally. That is, the step argument now takes an argument, which we may pick randomly or in a more intelligent manner.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">prism_mdp_slipgrid</span>
<span class="n">prism_program</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">parse_prism_program</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">prism_program</span><span class="p">)</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">create_simulator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># 3 paths of at most 20 steps.</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">available_actions</span><span class="p">()</span>
        <span class="n">select_action</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--act=</span><span class="si">{</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">]</span><span class="si">}</span><span class="s2">--&gt;&quot;</span><span class="p">)</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">])</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
            <span class="k">break</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0 --act=1--&gt; 2 --act=0--&gt; 2 --act=0--&gt; 4 --act=2--&gt; 1 --act=1--&gt; 3 --act=1--&gt; 3 --act=2--&gt; 7 --act=2--&gt; 3 --act=0--&gt; 1 --act=2--&gt; 4 --act=1--&gt; 4 --act=2--&gt; 4 --act=3--&gt; 8 --act=0--&gt; 5 --act=0--&gt; 8 --act=3--&gt; 12 --act=0--&gt; 12 --act=0--&gt; 9 --act=0--&gt; 9 --act=1--&gt; 5
------
0 --act=1--&gt; 0 --act=0--&gt; 0 --act=1--&gt; 2 --act=1--&gt; 0 --act=0--&gt; 0 --act=0--&gt; 1 --act=0--&gt; 0 --act=1--&gt; 2 --act=2--&gt; 5 --act=0--&gt; 8 --act=1--&gt; 11 --act=2--&gt; 7 --act=2--&gt; 3 --act=2--&gt; 7 --act=2--&gt; 3 --act=2--&gt; 3 --act=1--&gt; 3 --act=2--&gt; 3 --act=0--&gt; 1 --act=1--&gt; 3
------
0 --act=0--&gt; 1 --act=2--&gt; 4 --act=3--&gt; 4 --act=3--&gt; 4 --act=1--&gt; 4 --act=1--&gt; 7 --act=1--&gt; 10 --act=2--&gt; 10 --act=1--&gt; 6 --act=0--&gt; 3 --act=2--&gt; 7 --act=0--&gt; 4 --act=0--&gt; 2 --act=0--&gt; 4 --act=3--&gt; 8 --act=0--&gt; 5 --act=2--&gt; 9 --act=1--&gt; 5 --act=2--&gt; 9 --act=1--&gt; 9
------
</pre></div></div>
</div>
<p>In the example above, the actions are internal numbers. Often, a program gives semantically meaningful names, such as moving <code class="docutils literal notranslate"><span class="pre">north</span></code>, <code class="docutils literal notranslate"><span class="pre">east</span></code>, <code class="docutils literal notranslate"><span class="pre">west</span></code> and <code class="docutils literal notranslate"><span class="pre">south</span></code> in a grid with program variables reflecting the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> location.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">BuilderOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">set_build_choice_labels</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">set_build_state_valuations</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">build_sparse_model_with_options</span><span class="p">(</span><span class="n">prism_program</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">create_simulator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">set_action_mode</span><span class="p">(</span><span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">SimulatorActionMode</span><span class="o">.</span><span class="n">GLOBAL_NAMES</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">set_observation_mode</span><span class="p">(</span><span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">SimulatorObservationMode</span><span class="o">.</span><span class="n">PROGRAM_LEVEL</span><span class="p">)</span>
<span class="c1"># 3 paths of at most 20 steps.</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">available_actions</span><span class="p">()</span>
        <span class="n">select_action</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">]</span><span class="si">}</span><span class="s2">--&gt;&quot;</span><span class="p">)</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">])</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
            <span class="k">break</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1,1) --west--&gt; (1,2) --south--&gt; (1,2) --east--&gt; (1,2) --east--&gt; (1,1) --west--&gt; (1,2) --east--&gt; (1,1) --south--&gt; (2,1) --south--&gt; (2,1) --north--&gt; (1,1) --south--&gt; (2,1) --west--&gt; (2,1) --north--&gt; (2,1) --west--&gt; (2,2) --west--&gt; (2,2) --south--&gt; (3,2) --east--&gt; (3,2) --south--&gt; (4,2) --west--&gt; (4,2) --west--&gt; (4,2) --north--&gt; (3,2)
(1,1) --west--&gt; (1,1) --south--&gt; (1,1) --west--&gt; (1,2) --south--&gt; (1,2) --south--&gt; (1,2) --west--&gt; (1,3) --east--&gt; (1,2) --east--&gt; (1,2) --south--&gt; (2,2) --south--&gt; (3,2) --south--&gt; (4,2) --west--&gt; (4,3) --north--&gt; (3,3) --south--&gt; (4,3) --west--&gt; (4,4) --north--&gt; (3,4) --east--&gt; (3,3) --west--&gt; (3,3) --north--&gt; (2,3) --east--&gt; (2,3)
(1,1) --south--&gt; (2,1) --south--&gt; (3,1) --south--&gt; (3,1) --north--&gt; (2,1) --north--&gt; (1,1) --south--&gt; (2,1) --south--&gt; (3,1) --south--&gt; (3,1) --west--&gt; (3,2) --south--&gt; (3,2) --west--&gt; (3,3) --east--&gt; (3,2) --south--&gt; (3,2) --north--&gt; (3,2) --north--&gt; (3,2) --south--&gt; (3,2) --south--&gt; (4,2) --east--&gt; (4,1) --north--&gt; (4,1) --west--&gt; (4,2)
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Program-level-simulator">
<h2>Program-level simulator<a class="headerlink" href="#Program-level-simulator" title="Permalink to this heading">¶</a></h2>
<p>We can also use a program-level simulator, which does not require putting the model into memory.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">stormpy</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">create_simulator</span><span class="p">(</span><span class="n">prism_program</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 paths of at most 20 steps.</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">available_actions</span><span class="p">()</span>
        <span class="n">select_action</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">]</span><span class="si">}</span><span class="s2">--&gt;&quot;</span><span class="p">)</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">select_action</span><span class="p">])</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
            <span class="k">break</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1,1) --0--&gt; (2,1) --0--&gt; (1,1) --1--&gt; (1,2) --1--&gt; (1,1) --1--&gt; (1,2) --0--&gt; (2,2) --3--&gt; (2,3) --0--&gt; (1,3) --2--&gt; (1,3) --2--&gt; (1,4) --0--&gt; (2,4) --2--&gt; (2,3) --2--&gt; (2,2) --3--&gt; (2,2) --3--&gt; (2,3) --2--&gt; (2,2) --0--&gt; (2,2) --2--&gt; (2,2) --0--&gt; (1,2) --0--&gt; (2,2)
(1,1) --0--&gt; (2,1) --1--&gt; (2,1) --2--&gt; (2,2) --3--&gt; (2,2) --1--&gt; (2,2) --1--&gt; (3,2) --0--&gt; (2,2) --2--&gt; (2,1) --2--&gt; (2,2) --0--&gt; (2,2) --1--&gt; (3,2) --3--&gt; (3,3) --3--&gt; (3,3) --2--&gt; (3,2) --0--&gt; (2,2) --2--&gt; (2,2) --3--&gt; (2,2) --0--&gt; (1,2) --0--&gt; (2,2) --3--&gt; (2,3)
(1,1) --0--&gt; (2,1) --2--&gt; (2,2) --0--&gt; (1,2) --0--&gt; (2,2) --3--&gt; (2,2) --3--&gt; (2,3) --0--&gt; (1,3) --1--&gt; (1,3) --2--&gt; (1,4) --1--&gt; (1,4) --1--&gt; (1,3) --2--&gt; (1,4) --0--&gt; (2,4) --2--&gt; (2,3) --2--&gt; (2,2) --2--&gt; (2,2) --0--&gt; (1,2) --0--&gt; (2,2) --0--&gt; (2,2) --3--&gt; (2,3)
</pre></div></div>
</div>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/doc/simulator.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016-2021 Moves RWTH Aachen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>